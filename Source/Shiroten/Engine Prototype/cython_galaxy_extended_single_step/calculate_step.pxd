cpdef void calculate_step(double [:, :], double [:, :], double [:, :], double [:, :], \
                          double [:], double [:, :], double, int, int, int)