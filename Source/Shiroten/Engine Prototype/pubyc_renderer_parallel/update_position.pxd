cdef void update_position (double [:, :], double [:, :], double [:, :],double [:, :], double, int, int) nogil