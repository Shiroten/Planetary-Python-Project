cdef void update_speed (double [:, :], double [:, :], double [:, :], double, int, int) nogil