cdef void update_position (double [:, :], double [:, :], double [:, :], double [:, :], double, int) nogil