cdef void update_speed (double [:, :], double [:, :], double [:], double, int) nogil